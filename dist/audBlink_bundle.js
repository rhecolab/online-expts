(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{startTask:()=>p});const o=new(window.AudioContext||window.webkitAudioContext),n={};async function s(t){for(const e of t){const t=`../../stimuli/snds/${e}.wav`,s=await fetch(t),h=await s.arrayBuffer();n[e]=await o.decodeAudioData(h)}console.log("sounds preloaded")}function h(t,e,s=!1){!0===s?$("#fix").text(""):$("#fix").text("+");const h=o.createBufferSource();h.buffer=n[t],h.connect(o.destination),h.start(e)}window.playSound=h,window.preloadSounds=s;const i=300,l=300;let a=0,r=[],c=null,d=0,u=0,_=[],f={},g="";async function p(t){g=t;const e=function(t,e,o){let n=[];for(let s=0;s<o.length;s++)for(let h=0;h<t.length;h++)for(let i=0;i<e.length;i++)for(let l=0;l<2;l++)n.push({t1:t[h],t2:e[i],lag:o[s]});for(let t=n.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[n[t],n[e]]=[n[e],n[t]]}return n}(["glide_up","glide_down"],["a1_sh","a2_sh","a8_sh","a9_sh"],[0,3,9]);_=function(t){let e=[],o=[];e=["h1_sh","h2_sh","h3_sh","h4_sh","h5_sh","h6_sh","h7_sh","h8_sh","h9_sh","h10_sh","i1_sh","i2_sh","i3_sh","i4_sh","i5_sh","i6_sh","i7_sh","i8_sh","i9_sh","i10_sh"];for(let n=0;n<t.length;n++){let s=[];const{t1:h,t2:i,lag:l}=t[n],a=Math.floor(5*Math.random())+1;for(let t=0;t<a;t++){const t=e[Math.floor(Math.random()*e.length)];s.push({stim:t,type:"d"})}s.push({stim:h,type:"t1"});for(let t=0;t<l;t++){const t=e[Math.floor(Math.random()*e.length)];s.push({stim:t,type:"d"})}s.push({stim:i,type:"t2"});for(let t=0;t<3;t++){const t=e[Math.floor(Math.random()*e.length)];s.push({stim:t,type:"d"})}o.push({trialNum:n,t1:h,t2:i,lag:l,stimOrder:s})}return o}(e),window.trials=e,u=window.trials.length,f=await s(["glide_up","glide_down","a1_sh","a2_sh","a8_sh","a9_sh","h1_sh","h2_sh","h3_sh","h4_sh","h5_sh","h6_sh","h7_sh","h8_sh","h9_sh","h10_sh","i1_sh","i2_sh","i3_sh","i4_sh","i5_sh","i6_sh","i7_sh","i8_sh","i9_sh","i10_sh"]),document.getElementById("startButton").addEventListener("click",()=>{document.getElementById("instrBox").style.display="none",document.getElementById("startButton").style.display="none",m(_[a])})}function m(t){c=t,d=NaN;const e=t.stimOrder;let n=o.currentTime;for(let t=0;t<e.length;t++)h(e[t].stim,n),w(n),y(n+i/1e3),n+=(i+l)/1e3;const s=e.length*(i+l);setTimeout(()=>collectResp(1,t),s)}function w(t){const e=1e3*(t-o.currentTime);setTimeout(()=>{$("#fix").text("+")},e)}function y(t){const e=1e3*(t-o.currentTime);setTimeout(()=>{$("#fix").text("")},e)}window.collectResp=function(t,e=null){const o=trials[a];console.log("t1",o.t1),console.log("t2",o.t2),console.log("lag",o.lag),1===t&&(new Date,d={t1_item:o.t1,t2_item:o.t2,lag:o.lag,resp1:"",resp2:""}),2===t&&null!==e&&(d.resp1=e),3===t&&null!==e&&(d.resp2=e),1===t&&($("#q1").show(),$("#q2").hide()),2===t&&($("#q1").hide(),$("#q2").show()),3===t&&(r.push(d),d=null,$("#q1, #q2").hide(),a++,a<u?m(_[a]):function(t){document.getElementById("exptBox").innerText="Task complete!",console.log("Subject ID:",t),console.log("Data:",r),function(t,e,o){const n=(new Date).toISOString().split("T")[0].replace(/-/g,""),s=`${t}_${e}_${n}`,h=Object.keys(o[0]);let i="sub,"+h.join(",")+",taskName\n";o.forEach(o=>{const n=h.map(t=>o[t]??"");i+=`${t},${n.join(",")},${e}\n`}),fetch("/save-results",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file:s,csv:i})}).then(t=>t.text()).then(t=>console.log("saved",t)).catch(t=>console.error("error:",t))}(t,"audBlink",r)}(g))},window.ablink=e})();